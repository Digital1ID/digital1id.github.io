<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‚öΩ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏ü‡∏∏‡∏ï‡∏ö‡∏≠‡∏•‡∏™‡∏î</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      background: #f4f6f9;
      color: #333;
    }
    header {
      background: linear-gradient(90deg, #0066ff, #00ccff);
      color: white;
      padding: 20px;
      text-align: center;
      font-size: 1.5em;
      font-weight: bold;
    }
    .player {
      margin: 20px auto;
      text-align: center;
      display: none; /* ‚úÖ ‡∏ã‡πà‡∏≠‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡πà‡∏ô‡∏Å‡πà‡∏≠‡∏ô */
    }
    video {
      width: 80%;
      max-width: 900px;
      border: 3px solid #0066ff;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }
    select, input[type="text"] {
      margin-top: 10px;
      padding: 8px;
      border-radius: 4px;
      border: 1px solid #ccc;
      font-size: 1em;
    }
    .search-bar {
      width: 95%;
      margin: 10px auto;
      text-align: right;
    }
    table {
      width: 95%;
      margin: 20px auto;
      border-collapse: collapse;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      background: white;
      border-radius: 8px;
      overflow: hidden;
    }
    th, td {
      padding: 12px;
      text-align: center;
      border-bottom: 1px solid #ddd;
    }
    th {
      background: #0066ff;
      color: white;
    }
    tr:hover {
      background: #f1f9ff;
    }
    button {
      background: #00ccff;
      border: none;
      padding: 8px 12px;
      border-radius: 4px;
      color: white;
      cursor: pointer;
      transition: 0.3s;
    }
    button:hover {
      background: #0099cc;
    }
    img.logo {
      height: 20px;
      vertical-align: middle;
      margin-right: 5px;
    }
    .league-header {
      background: #333;
      color: #fff;
      font-weight: bold;
      text-align: left;
      padding: 8px;
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
</head>
<body>
  <header>üì∫ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏ü‡∏∏‡∏ï‡∏ö‡∏≠‡∏•‡∏™‡∏î</header>

  <div class="player" id="playerBox">
    <h2>üé¨ ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡πà‡∏ô‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠</h2>
    <video id="videoPlayer" controls></video><br>
    <select id="channelSelect" onchange="playStream(this.value)">
      <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏ñ‡πà‡∏≤‡∏¢‡∏ó‡∏≠‡∏î‡∏™‡∏î --</option>
    </select>
  </div>

  <div class="search-bar">
    <input type="text" id="searchInput" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ó‡∏µ‡∏°/‡∏•‡∏µ‡∏Å..." onkeyup="filterTable()">
  </div>

  <table id="matchesTable">
    <thead>
      <tr>
        <th>‡∏•‡∏µ‡∏Å</th>
        <th>‡∏ó‡∏µ‡∏°‡πÄ‡∏´‡∏¢‡πâ‡∏≤</th>
        <th>‡∏ó‡∏µ‡∏°‡πÄ‡∏¢‡∏∑‡∏≠‡∏ô</th>
        <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
        <th>‡πÄ‡∏ß‡∏•‡∏≤</th>
        <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
        <th>‡∏ä‡πà‡∏≠‡∏á</th>
        <th>‡∏î‡∏π‡∏™‡∏î</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const channelMap = {};

    async function parseMatches() {
      try {
        const res = await fetch("https://api-soccer.thai-play.com/api/v4/iptv/livescore/now?token=JF6pHMnpVCRUeEsSqAAjTWA4GbGhMrpD");
        const htmlText = await res.text();

        const parser = new DOMParser();
        const doc = parser.parseFromString(htmlText, "text/html");

        const containers = doc.querySelectorAll("div.row.gy-3");
        const tbody = document.querySelector("#matchesTable tbody");
        const channelSelect = document.getElementById("channelSelect");

        let currentLeague = "";

        containers.forEach(container => {
          const statusNode = container.querySelector("div.col-lg-1 div");
          const statusText = statusNode ? statusNode.textContent.trim() : "";
          if (statusText.toUpperCase() === "FT") return;

          const matchTime = statusText.replace(/(\d{1,2}):(\d{2})/, "$1.$2");
          const homeTeam = container.querySelector("div.text-end p")?.textContent.trim() || "‡∏ó‡∏µ‡∏°‡πÄ‡∏´‡∏¢‡πâ‡∏≤";
          const awayTeam = container.querySelector("div.text-start p")?.textContent.trim() || "‡∏ó‡∏µ‡∏°‡πÄ‡∏¢‡∏∑‡∏≠‡∏ô";

          // ‚úÖ ‡∏î‡∏∂‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏µ‡∏Å‡∏à‡∏≤‡∏Å sibling ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
          const leagueNode = container.closest("div.col-lg-12").previousElementSibling?.querySelector("strong.text-uppercase");
          const leagueFull = leagueNode ? leagueNode.textContent.trim().replace("|", ":") : "‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏•‡∏µ‡∏Å";

          const dateNode = container.closest("div").querySelector("b.fs-4");
          const thaiDate = dateNode ? dateNode.textContent.trim() : new Date().toLocaleDateString("th-TH");

          // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏•‡∏µ‡∏Å ‚Üí ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÉ‡∏´‡∏°‡πà
          if (leagueFull !== currentLeague) {
            currentLeague = leagueFull;
            const leagueRow = document.createElement("tr");
            leagueRow.innerHTML = `<td colspan="8" class="league-header">${currentLeague}</td>`;
            tbody.appendChild(leagueRow);
          }

          const streams = container.querySelectorAll("img.iam-list-tv");
          const seenChannels = new Set();

          streams.forEach(stream => {
            const channel = stream.getAttribute("alt");
            if (seenChannels.has(channel)) return; // ‚úÖ ‡∏Å‡∏£‡∏≠‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏ã‡πâ‡∏≥
            seenChannels.add(channel);

            let url = stream.getAttribute("data-url");
            const logo = stream.getAttribute("src");
            if (!url) return;
            url = url.replace(":443", "").replace("/dooballfree-com/", "/do-ball.com/");

            // ‚úÖ ‡∏£‡∏ß‡∏°‡∏ä‡πà‡∏≠‡∏á‡∏ã‡πâ‡∏≥‡πÄ‡∏õ‡πá‡∏ô dropdown (‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß)
            if (!channelMap[channel]) {
              channelMap[channel] = { url, logo };
              const opt = document.createElement("option");
              opt.value = url;
              opt.textContent = channel;
              channelSelect.appendChild(opt);
            }

            const tr = document.createElement("tr");
            tr.innerHTML = `
              <td>${leagueFull}</td>
              <td>${homeTeam}</td>
              <td>${awayTeam}</td>
              <td>${thaiDate}</td>
              <td>${matchTime}</td>
              <td>${statusText}</td>
              <td><img src="${logo}" class="logo" alt="${channel}"> ${channel}</td>
              <td><button onclick="playStream('${url}')">‡πÄ‡∏•‡πà‡∏ô</button></td>
            `;
            tbody.appendChild(tr);
          });
        });
      } catch (err) {
        document.querySelector("#matchesTable tbody").innerHTML =
          `<tr><td colspan="8">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô</td></tr>`;
      }
    }

    function playStream(url) {
      if (!url) return;
      document.getElementById("playerBox").style.display = "block"; // ‚úÖ ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î‡πÄ‡∏•‡πà‡∏ô
      const video = document.getElementById("videoPlayer");
      if (Hls.isSupported()) {
        const hls = new Hls();
        hls.loadSource(url);
        hls.attachMedia(video);
        video.play();
      } else if (video.canPlayType("application/vnd.apple.mpegurl")) {
        video.src = url;
        video.play();
      } else {
        alert("‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô‡∏™‡∏ï‡∏£‡∏µ‡∏° .m3u8");
      }
    }

    function filterTable() {
      const input = document.getElementById("searchInput").value.toLowerCase();
      const rows = document.querySelectorAll("#matchesTable tbody tr");
      rows.forEach(row => {
        if (row.classList.contains("league-header")) {
          row.style.display = "";
          return;
        }
        const text = row.textContent.toLowerCase();
        row.style.display = text.includes(input) ? "" : "none";
      });
    }

    parseMatches();
  </script>
</body>
</html>