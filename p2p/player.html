<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="referrer" content="no-referrer">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta http-equiv="Cache-Control" content="max-age=3600, public">
  <title>Movie Player</title>
  <link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet" />
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-[#141414] text-white font-sans">

  <!-- Header -->
  <header class="bg-[#141414] shadow-lg">
    <div class="container mx-auto px-4 py-4 flex justify-start items-center">
      <a href="../movie.html">
        <h1 class="text-3xl font-extrabold text-[#E50914] tracking-wider">
          FLIX <span class="text-white">Movie</span>
        </h1>
      </a>
    </div>
  </header>

  <!-- Main -->
  <main class="relative w-full h-screen bg-black overflow-hidden">

  <!-- Video -->
  <video
    id="my-video"
    class="w-full h-full object-contain bg-black"
    controls
    autoplay>
    <source id="videoSource" src="" type="">
  </video>

  <!-- Gradient Overlay -->
  <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/30 to-transparent pointer-events-none"></div>

  <!-- Top Bar -->
  <div class="absolute top-0 left-0 w-full flex justify-between items-center p-5 z-10">
    <a href="../movie.html"
       class="text-white text-sm md:text-base font-semibold bg-black/50 px-4 py-2 rounded hover:bg-black/80 transition">
       ← ย้อนกลับ
    </a>

    <button id="reloadBtn"
       class="text-white text-sm md:text-base font-semibold bg-red-600/70 px-4 py-2 rounded hover:bg-red-600 transition">
       โหลดซ้ำ
    </button>
  </div>

  <!-- Title Bottom -->
  <div class="absolute bottom-0 left-0 w-full p-6 z-10">
    <h1 id="videoTitle"
        class="text-2xl md:text-4xl font-extrabold text-white drop-shadow-lg">
        กำลังโหลด...
    </h1>
  </div>

</main>

<script>
const params = new URLSearchParams(window.location.search);
let file = params.get("file");
let name = params.get("name");

if (file) file = decodeURIComponent(file);
if (name) name = decodeURIComponent(name);

const videoSource = document.getElementById("videoSource");
const video = document.getElementById("my-video");
const videoTitle = document.getElementById("videoTitle");

// ตั้งชื่อ
if (name) {
  document.title = name;
  videoTitle.textContent = name;
}

// ตั้งค่า source แบบเสถียรสุด
if (file) {
  videoSource.src = file;
  videoSource.type = file.includes(".m3u8")
    ? "application/x-mpegURL"
    : "video/mp4";

  video.load();
}

// Reload
document.getElementById("reloadBtn").addEventListener("click", (e) => {
  e.preventDefault();
  location.reload();
});
</script>
  <script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>
</body>
</html>
