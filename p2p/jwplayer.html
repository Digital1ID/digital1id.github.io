<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>ดูหนังใหม่ ดูซี่รี่ย์ใหม่</title>

  <!-- Bootstrap + Font -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@200;400;600&display=swap" rel="stylesheet">

  <style>
    body {
      margin: 0;
      font-family: 'Sarabun', sans-serif;
      background-color: #000;
      width: 100vw;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    #play {
      width: 100vw;
      height: 100vh;
    }
    .back-button, .reload-button, .switch-button {
      position: fixed;
      top: 15px;
      z-index: 10000;
      padding: 8px 12px;
      border-radius: 4px;
      text-decoration: none;
      font-size: 14px;
      backdrop-filter: blur(4px);
      transition: background-color 0.3s;
      color: #fff;
    }
    .back-button {
      left: 15px;
      background-color: rgba(255, 255, 255, 0.2);
    }
    .back-button:hover {
      background-color: rgba(255, 255, 255, 0.4);
    }
    .reload-button {
      right: 20px;
      background-color: rgba(0, 123, 255, 0.3);
    }
    .reload-button:hover {
      background-color: rgba(0, 123, 255, 0.6);
    }
    .switch-button {
      left: 20px;
      background-color: rgba(40, 167, 69, 0.3);
    }
    .switch-button:hover { 
      background-color: rgba(40,167,69,0.6); 
    }
    #videoTitle {
      position: fixed;
      bottom: 60px;
      left: 20px;
      color: #fff;
      background: rgba(0,0,0,0.5);
      padding: 6px 12px;
      border-radius: 4px;
      font-size: 16px;
      z-index: 10000;
    }
  </style>
</head>
<body>
  <!--a href="../movie.html" class="back-button">ย้อนกลับ</a-->
  <a href="#" id="switchBtn" class="switch-button">สลับ Player</a>
  <a href="#" id="reloadBtn" class="reload-button">โหลดซ้ำ</a>

  <div id="play"></div>
  <div id="videoTitle"></div>

  <!-- JWPlayer -->
  <script src="jw/jwplayer.js"></script>
  <script>
    jwplayer.key = "eNFaXCjyURVoCCGiHp7HTQ3hDhE/AfL0g8VE1fRbL84=";

    const params = new URLSearchParams(window.location.search);
    let file = params.get("file");
    let name = params.get("name");

    if (file) file = decodeURIComponent(file);
    if (name) name = decodeURIComponent(name);

    window.onload = function () {
      if (file) {
        if (name) {
          document.title = name;
          document.getElementById("videoTitle").innerText = name;
        }

        jwplayer("play").setup({
          width: "100%",
          height: "100%",
          aspectratio: "16:9",
          playlist: [{
            sources: [{
              file: file,
              label: "HD",
              type: file.includes(".m3u8") ? "hls" : "mp4"
            }]
          }],
          primary: "html5",
          hlshtml: true,
          autostart: true
        });
      } else {
        document.getElementById("videoTitle").innerText = "ไม่พบไฟล์วิดีโอ";
      }
    };

    // reload button
    document.getElementById("reloadBtn").addEventListener("click", (e) => {
      e.preventDefault();
      if (file) {
        jwplayer("play").load([{
          sources: [{
            file: file,
            label: "HD",
            type: file.includes(".m3u8") ? "hls" : "mp4"
          }]
        }]);
        jwplayer("play").play();
      }
    });
    
    // switch button
    document.getElementById("switchBtn").addEventListener("click", (e) => {
      e.preventDefault();
      const newEngine = engine === "jwplayer" ? "videojs" : "jwplayer";
      const newUrl = new URL(window.location.href);
      newUrl.searchParams.set("engine", newEngine);
      window.location.href = newUrl.toString();
    });
  </script>
</body>
</html>